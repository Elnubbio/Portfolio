@using FuzzySharp;

<h1 class="text-center">Music Quiz MAIN</h1>



<div class="d-flex justify-content-center m-5">
	<label>@currentLyrics</label>
</div>

<div class="d-flex justify-content-center m-5">
	<button @onclick="revealWord" class="btn btn-primary" style=" visibility: @showingAllLyrics">Reveal next word</button>
</div>

<div class="d-flex justify-content-center m-5">
	<input @bind="userInput"/>
	<button @onclick="checkAnswer">Submit</button>
</div>


@code 
{
	int score = 0;
	string CurrentSong = "";
	int currentSongNumber = 0;
	string currentLyrics =  " ";
	int numberOfLyricsDisplaying = 0;
	string showingAllLyrics = "visible";
	string userInput = "";

	[Parameter]
	public List<List<string>> AllLyrics { get; set; }

	private string chooseSentence()
	{
		Random rand = new();
		int index = rand.Next(0, AllLyrics.Count());
		return AllLyrics[currentSongNumber][index];
	}
	//TODO fix button moving when first word appears
	private void revealWord()
	{
		currentLyrics += AllLyrics[currentSongNumber][numberOfLyricsDisplaying] + " ";
		numberOfLyricsDisplaying++;

		if (numberOfLyricsDisplaying >= AllLyrics.Count)
		{
			showingAllLyrics = "hidden";			
		}
	}

	private void checkAnswer()
	{
		//Compare strings
		CurrentSong = CurrentSong.Replace("-", "");
		userInput = userInput.Replace(" ", "");
		Console.WriteLine(userInput);
		Console.WriteLine(CurrentSong);

		double similarityScore = Fuzz.Ratio(userInput, CurrentSong);

		Console.WriteLine($"Similarity Score: {similarityScore}");
		if (similarityScore >= 85)
		{
			Console.WriteLine("Correct");
		} else
		{
			Console.WriteLine("WRONG");
		}

	}
}
